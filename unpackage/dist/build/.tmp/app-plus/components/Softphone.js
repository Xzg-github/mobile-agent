(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/Softphone"],{"1cee":function(e,t,n){"use strict";(function(e,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n("2f62"),s=function(){return n.e("components/softphone/Login").then(n.bind(null,"2272"))},i=function(){return n.e("components/softphone/Logining").then(n.bind(null,"c4a1"))},l=function(){return n.e("components/softphone/Available").then(n.bind(null,"055c"))},r=function(){return n.e("components/softphone/AgreeLogin").then(n.bind(null,"efca"))},c=function(){return n.e("components/softphone/Callphone").then(n.bind(null,"b0e3"))},h=function(){return n.e("components/softphone/Handup").then(n.bind(null,"b156"))},u=function(){return n.e("components/softphone/Callsuccess").then(n.bind(null,"bb09"))},g=function(){return n.e("components/softphone/Hold").then(n.bind(null,"a6d4"))},d=function(){return n.e("components/softphone/Consult").then(n.bind(null,"75bd"))},f=function(){return n.e("components/softphone/Meeting").then(n.bind(null,"f875"))},p=function(){return n.e("components/softphone/Reprocessing").then(n.bind(null,"b565"))},m=function(){return n.e("components/softphone/Callcontent").then(n.bind(null,"6acc"))},b=function(){return n.e("components/softphone/Answer").then(n.bind(null,"5e84"))},v={props:{class_a:String,socketObj:Object,phone:Number,pageName:String,toCallFlag:String},computed:(0,o.mapState)(["hasLogin","uerInfo"]),components:{Login:s,AgreeLogin:r,Available:l,Callphone:c,Handup:h,Callsuccess:u,Hold:g,Consult:d,Meeting:f,Reprocessing:p,Logining:i,Callcontent:m,Answer:b},data:function(){return{expand:!1,timer_inter:!1,timer:"00:00:00",phonenum:"",state:!1,show:1,meeting_flag:!1,leftval:"",NumArr:[1,2,3,4,5,6,7,8,9,0],setStateActiveCallId:"",setStateCallId:"",otherPage:!1,callPhone:"",endDate:"",starDate:"",city:"",province:"",phoneCode:"",callStartTime:"",phoneArea:{},requestFlag:!1,endTime:"",customerCode:"",customerName:"",bossFlag:!1,callFlag:"",connectFlag:""}},watch:{socketObj:function(t,n){var o=this;if(o.getTimeDate(),1==t.res)switch(t.Method){case"init":o.show=11;break;case"agent_login":o.show=2;break;case"agent_logout":o.show=1;break;case"agent_available":o.show=3;break;case"agent_auxwork":break;case"make_call":o.show=12;break;case"answer":o.show=6;break;case"hangup":break;case"hold":o.show=7;break;case"unhold":o.show=6;break;case"ini_consult":o.show=8;break;case"finish_conference":o.show=9;break;case"finish_transfer":o.show=10;break;default:break}switch(t.eventname){case"ORIGINATED":o.meeting_flag||(o.show=12,o.setStateActiveCallId=t.callid,o.$emit("setStateActiveCallId",o.setStateActiveCallId));break;case"CONNECTION_CLEARED":o.callEndTime(),o.$emit("callEndTime",o.endTime),5==o.show?o.show=7:6==o.show?"-1"==t.localstate&&o.meeting_flag?o.show=7:o.show=10:7==o.show?"0"==t.localstate?o.show=10:"-1"==t.localstate?o.meeting_flag?o.show=10:1==o.state?o.show=10:o.show=7:"4"==t.localstate&&(o.show=10):8==o.show?o.meeting_flag&&"-1"!=t.localstate?o.show=5:o.show=7:10==o.show&&o.meeting_flag?o.show=7:o.show=10,o.meeting_flag=!1;break;case"DELIVERED":if(console.log(e(o.show," at components\\Softphone.vue:210")),o.meeting_flag||(o.setStateActiveCallId=t.callid,o.$emit("setStateActiveCallId",o.setStateActiveCallId)),o.otherPage)return!1;o.otherPage=!0;var s=getCurrentPages().length,i=getCurrentPages()[s-1].route;"pages/home/roster/callOut"==i||o.callFlag?"pages/home/roster/callOut"!=i||"首页"==o.pageName||o.toCallFlag||(o.$emit("getPageLen",2),a.switchTab({url:"/pages/index/home"}),o.toCallFlag=!0):(o.callPhone=t.callinfo.split("/")[0],o.$emit("getPhoneObj",o.callPhone),o.$emit("getPageLen",2),a.switchTab({url:"/pages/index/home"}));var l=t.callinfo.split("/")[0],r=t.callinfo.split("/")[1];l.length>6?(o.show=13,o.phonenum=l,o.setStateActiveCallId=t.callid):l.length!=r.length||o.meeting_flag?o.meeting_flag?o.show=8:o.show=5:(o.uerInfo.extension==l?o.show=5:o.show=13,o.phonenum=l,o.setStateActiveCallId=t.callid,o.bossFlag=!0);break;case"ESTABLISHED":if(o.connectFlag="Y",o.$emit("connectFlag",o.connectFlag),a.setStorage({key:"endPhoneFlag",data:!1,success:function(){}}),o.meeting_flag)o.show=8;else if(o.show=6,o.getLastimes(),o.$emit("callStartTime",o.callStartTime),"首页"==o.pageName){var c=t.callinfo.split("/"),h=parseInt(c[0]).toString(),u=parseInt(c[1]).toString();0==o.requestFlag&&(h.length>6?(o.apiinsAdd("1",h,u),o.requestFlag=!0):u.length>6&&(o.apiinsAdd("0",h,u),o.requestFlag=!0))}break;case"SERVICE_INITIATED":console.log(e(o.show," at components\\Softphone.vue:311")),o.setStateCallId=t.callid;break;case"TRANSFERRED":console.log(e(o.show," at components\\Softphone.vue:316")),o.show=10;break;default:break}}},mounted:function(){this.getTimeDate(),this.endDate=this.getCurrentDays(),this.starDate=this.getPrevMonthDays(),this.phonenum=this.phone},methods:{apiinsAdd:function(t,n,o){"0"==t?(this.getPhoneCode(o),this.getCusInfo(o)):(this.getPhoneCode(n),this.getCusInfo(n)),a.request({method:"POST",url:this.apiDomian+"/serviceLog/apiinsAdd",data:{callType:t,ani:n,dnis:o,customerCode:this.customerCode,customerName:this.customerName,userCode:this.uerInfo.username,userName:this.uerInfo.nickname,organCode:this.uerInfo.organCode,organNamee:this.uerInfo.organName,agentNo:this.uerInfo.extension,serviceLog:"",campaignId:"",batchId:"",taskId:"",phoneCode:this.phoneArea.phoneCode,province:this.phoneArea.province,city:this.phoneArea.city,callId:this.setStateActiveCallId,callStartTime:this.callStartTime},header:{"content-type":"application/json",Authorization:"Arch6WithCloud "+this.uerInfo.token}}).then(function(t){console.log(e(t," at components\\Softphone.vue:378"))})},getCusInfo:function(e){var t=this;a.request({method:"GET",url:this.apiDomian+"/contact/page",data:{callFrom:e,callDirection:"",agentId:"",agentName:"",startDate:this.starDate,endDate:this.endDate},header:{"content-type":"application/json",Authorization:"Arch6WithCloud "+this.uerInfo.token}}).then(function(e){if(e[1].data.data){var n=e[1].data.data.records;t.customerCode=n[0].clientId,t.customerName=n[0].clientName}})},getPhoneCode:function(e){var t=this;a.request({method:"GET",url:this.apiDomian+"/phoneArea/getRegion",data:{phoneArea:e},header:{"content-type":"application/x-www-form-urlencoded",Authorization:"Arch6WithCloud "+t.uerInfo.token}}).then(function(e){var n=e[1].data.data;t.phoneArea=n,t.city=n.city,t.province=n.province,t.phoneCode=n.phoneCode})},getCurrentDays:function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1;n=n<10?"0"+n:n;var a=e.getDate();a=a<10?"0"+a:a;var o=t+"-"+n+"-"+a;return o},getPrevMonthDays:function(){var e=this.endDate,t=e.split("-"),n=t[0],a=t[1],o=t[2],s=new Date(n,a,0);s=s.getDate();var i=n,l=parseInt(a)-1;0==l&&(i=parseInt(i)-1,l=12);var r=o,c=new Date(i,l,0);c=c.getDate(),r>c&&(r=c),l<10&&(l="0"+l);var h=i+"-"+l+"-"+r;return h},getLastimes:function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1;n=n<10?"0"+n:n;var a=e.getDate(),o=e.getHours()<10?"0"+e.getHours():e.getHours(),s=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),i=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds(),l=t+"-"+n+"-"+a+" "+o+":"+s+":"+i;this.callStartTime=l},callEndTime:function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1;n=n<10?"0"+n:n;var a=e.getDate(),o=e.getHours()<10?"0"+e.getHours():e.getHours(),s=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),i=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds(),l=t+"-"+n+"-"+a+" "+o+":"+s+":"+i;this.endTime=l},getMsgSon:function(e,t){this.show=e,this.leftval=t},endPhone:function(t){var n=this;if(1!=t||n.bossFlag){var o="Method|agent_available";a.sendSocketMessage({data:o})}else a.getStorage({key:"endPhoneFlag",success:function(t){if(console.log(e(t," at components\\Softphone.vue:515")),!t.data)return a.showToast({title:"请填写服务小结",duration:1e3,icon:"none"}),!1}})},close:function(){this.expand=!0,this.$emit("expand","1")},changeOpen:function(){this.expand=!1,this.$emit("expand","2")},getState:function(e){this.state=e},getCallNum:function(e){this.phonenum=e.num,this.$emit("getPhoneObj",e)},setMeeting:function(e){this.meeting_flag=e},getCallPhoneFlag:function(e){this.callFlag=e},getTimeDate:function(){var e=this;e.timer="00:00:00",clearInterval(e.timer_inter);var t=0,n=0,a=0,o="";this.timer_inter=setInterval(function(){o="",60==++a&&(60==++n&&(t++,n=0),a=0),o+=t<10?"0"+t:t,o+=":",o+=n<10?"0"+n:n,o+=":",o+=a<10?"0"+a:a,e.timer=o},1e3)}}};t.default=v}).call(this,n("0de9")["default"],n("6e42")["default"])},"7c8b":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement;e._self._c},o=[];n.d(t,"a",function(){return a}),n.d(t,"b",function(){return o})},"801d":function(e,t,n){"use strict";n.r(t);var a=n("1cee"),o=n.n(a);for(var s in a)"default"!==s&&function(e){n.d(t,e,function(){return a[e]})}(s);t["default"]=o.a},9416:function(e,t,n){"use strict";n.r(t);var a=n("7c8b"),o=n("801d");for(var s in o)"default"!==s&&function(e){n.d(t,e,function(){return o[e]})}(s);var i=n("2877"),l=Object(i["a"])(o["default"],a["a"],a["b"],!1,null,null,null);t["default"]=l.exports}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/Softphone-create-component',
    {
        'components/Softphone-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('6e42')['createComponent'](__webpack_require__("9416"))
        })
    },
    [['components/Softphone-create-component']]
]);
